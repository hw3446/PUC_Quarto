[
  {
    "objectID": "PUC Analysis code_paper.html",
    "href": "PUC Analysis code_paper.html",
    "title": "PUC Analysis code",
    "section": "",
    "text": "knitr::opts_chunk$set(warning=FALSE, message=FALSE)\n\n#Part 1 ##Descriptive 1\n\nlibrary(tidyverse)\nlibrary(broom)\nlibrary(performance)\nlibrary(ordinal)\nlibrary(car)\nlibrary(ggeffects)\nlibrary(gofcat)\nlibrary(brms)\nlibrary(emmeans)\nlibrary(knitr)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(gridExtra)\nlibrary(grid)\nlibrary(MASS) \nlibrary(reshape2) \nlibrary(reshape) \nlibrary(logistf)\nlibrary(corrplot)\n\nFirst we load the data for the first half of the concert, removing columns we don’t want. I’ve also recoded the hall locations into two factors, ‘Downstairs’ and ‘Upstairs’.\n\n#Loading dataset, sheet 1\n\nlibrary(conflicted)\nconflict_prefer(\"filter\", \"dplyr\")\n\ndata_paper &lt;- read_csv(\"input/PUC1.csv\")\n\nFirst we need to recode some of the values in the dataframe.\n\nrecode &lt;- c(\"1\" = \"Not at all\",\n                \"2\" = \"A small amount of the time\",\n                \"3\" = \"A moderate amount of the time\",\n                \"4\" = \"Most of the time\",\n                \"5\" = \"All of the time\")\n\nrecode2 &lt;- c(\"1\" = \"Not at all\",\n             \"2\" = \"Slightly\",\n             \"3\" = \"Moderately\",\n             \"4\" = \"Mostly\",\n             \"5\" = \"Entirely\")\n\nrecode3 &lt;- c(\"1\" = \"Very rarely\",\n             \"2\" = \"Somewhat rarely\",\n             \"3\" = \"Moderately frequently\",\n             \"4\" = \"Frequently\",\n             \"5\" = \"Very frequently\")\n\ndata_paper[, 2:10] &lt;- lapply(data_paper[, 2:10], function(x) recode[as.character(x)])\ndata_paper[, 13:15] &lt;- lapply(data_paper[, 13:15], function(x) recode2[as.character(x)])\ndata_paper[, 18:20] &lt;- lapply(data_paper[, 18:20], function(x) recode2[as.character(x)])\ndata_paper[, 24] &lt;- lapply(data_paper[, 24], function(x) recode3[as.character(x)])\n\nThen we load the qualtrics data.\n\nlibrary(conflicted)\nconflict_prefer(\"filter\", \"dplyr\")\n\ndata_qualtrics &lt;- read_csv(\"input_qualtrics/PUC1.csv\")\ndata_qualtrics &lt;- data_qualtrics %&gt;% dplyr::filter(Finished == \"TRUE\") %&gt;% \n  dplyr::select(-StartDate, -EndDate, -Status, -Progress, -Duration, \n         -RecordedDate, -DistributionChannel, -UserLanguage, -Finished, -Q1, -ResponseId)\n\nThe way people select composer and movements is different for the two surveys so we need to get them in a matching format:\n\ncomposer_initials &lt;- data.frame(\n  composer = c(\"Beethoven\", \"Hough\"),\n  composer_initial = c(\"B\", \"H\")\n)\n\ndata_long &lt;- data_qualtrics %&gt;%\n  pivot_longer(\n    cols = starts_with(\"Movement\"),\n    names_to = \"source_col\",\n    values_to = \"movement_label\"\n  ) %&gt;%\n  filter(!is.na(movement_label)) %&gt;%\n  mutate(\n    composer = case_when(\n      str_detect(source_col, \"_B_\") ~ \"Beethoven\",\n      str_detect(source_col, \"_H_\") ~ \"Hough\"\n    ),\n    type = case_when(\n      str_detect(source_col, \"_mem$\") ~ \"mem\",\n      str_detect(source_col, \"_story$\") ~ \"story\"\n    ),\n    movement = as.integer(str_extract(movement_label, \"\\\\d+\"))\n  ) %&gt;%\n  left_join(composer_initials, by = \"composer\") %&gt;%\n  mutate(code = paste0(composer_initial, movement))\n\ndata_wide &lt;- data_long %&gt;%\n  dplyr::select(ID, type, code) %&gt;%\n  pivot_wider(\n    names_from = type,\n    values_from = code,\n    names_prefix = \"Movement_\"\n  )\n\nfinal_qualtrics &lt;- data_qualtrics %&gt;%\n  left_join(data_wide, by = \"ID\")\n\n\n# Combine the data frames\ndata &lt;- bind_rows(data_paper, final_qualtrics)\ndata &lt;- data%&gt;% dplyr::select(-Movement_H_story, -Movement_B_story, -Piece_story, -Movement_H_mem, -Movement_B_mem, -Piece_mem)\n\nA dataframe is created showing thought types in a long format with counts for each frequency.\n\nthought_types &lt;- c(\"Fictional_story\", \"Abstract_shapes\", \"Sensory_sensations\", \"Life_experiences\", \"Media\", \"Music\", \"Future_plans\", \"Building\", \"Everyday\")\n\nthoughts_long &lt;- data %&gt;%\n  pivot_longer(cols = thought_types,\n               names_to = \"Category\", \n               values_to = \"Response\") %&gt;%\n  count(Category, Response) %&gt;% \n  mutate(Response = factor(Response, \n                           levels = c(\"Not at all\", \n                                      \"A small amount of the time\", \n                                      \"A moderate amount of the time\", \n                                      \"Most of the time\", \n                                      \"All of the time\"))) %&gt;% \n  mutate(Category = factor(Category, levels = rev(c(\"Fictional_story\", \n                                                    \"Abstract_shapes\", \n                                                    \"Sensory_sensations\", \n                                                    \"Life_experiences\", \n                                                    \"Media\", \n                                                    \"Music\", \n                                                    \"Future_plans\", \n                                                    \"Building\", \n                                                    \"Everyday\")))) %&gt;% filter(!is.na(Response))\n\nThis dataframe is used for the first plot, which shows the counts for each type of thought during the first half.\n\nggplot(thoughts_long, aes(x = Response, y = Category, fill = n)) +\n  geom_tile(color = \"white\") +  # Add white borders to tiles\n  scale_fill_gradient(low = \"lightblue\", high = \"darkblue\") +  # Adjust color gradient\n  labs(title = \"Counts for Thought Types, First Half\", x = NULL, y = NULL, fill = \"Count\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels\n\n\n\n\n\n\n\nggsave(\"Plots/Descriptive/Overall thought counts, part1.png\", width = 7, height = 5, dpi = 300, bg = \"white\")\n\nThen we examine the counts for the movements people select as invoking the most vivid memory or story.\n\nmems &lt;- data$Movement_mem %&gt;% na.omit() %&gt;% toupper()\nstories &lt;- data$Movement_story %&gt;% na.omit() %&gt;% toupper()\n\n\n# Split values by \";\", \",\", or whitespace\nsplit_values_mem &lt;- unlist(strsplit(mems, \"[; ,]+\"))\nsplit_values_story &lt;- unlist(strsplit(stories, \"[; ,]+\"))\n\n# Trim whitespace\nsplit_values_mem &lt;- trimws(split_values_mem)\nsplit_values_story &lt;- trimws(split_values_story)\n\n# Count occurrences\nvalue_counts_mem &lt;- table(split_values_mem)\nvalue_counts_story &lt;- table(split_values_story)\n\nThe movement counts are then plotted.\n\n#Reorder the Movement factor levels for Beethoven and Hough\n\nrecode_map &lt;- c(\"B1\" = \"Beethoven, Movement 1 — Allegro con brio\",\n                \"B2\" = \"Beethoven, Movement 2 — Adagio affettuoso ed appassionato\",\n                \"B3\" = \"Beethoven, Movement 3 — Scherzo\",\n                \"B4\" = \"Beethoven, Movement 4 — Allegro\",\n                \"H1\" = \"Hough, Movement 1 — Au boulevard\",\n                \"H2\" = \"Hough, Movement 2 — Au parc\",\n                \"H3\" = \"Hough, Movement 3 — À l'hôtel\",\n                \"H4\" = \"Hough, Movement 4 — Au théâtre\",\n                \"H5\" = \"Hough, Movement 5 — À l'église\",\n                \"H6\" = \"Hough, Movement 6 — Au marché\")\n\n\n# Recode values to descriptive names using recode_map\nrecoded_mem &lt;- dplyr::recode(split_values_mem, !!!recode_map)\nrecoded_story &lt;- dplyr::recode(split_values_story, !!!recode_map)\n\n# Convert recoded values to data frames\ndf_mem_counts &lt;- as.data.frame(table(recoded_mem))\ncolnames(df_mem_counts) &lt;- c(\"Movement\", \"count\")\n\ndf_story_counts &lt;- as.data.frame(table(recoded_story))\ncolnames(df_story_counts) &lt;- c(\"Movement\", \"count\")\n\n# Add a Composer column (Beethoven for B1-B4, Hough for H1-H6)\ndf_mem_counts$Composer &lt;- ifelse(grepl(\"^Beethoven\", df_mem_counts$Movement), \"Beethoven\", \"Hough\")\ndf_story_counts$Composer &lt;- ifelse(grepl(\"^Beethoven\", df_story_counts$Movement), \"Beethoven\", \"Hough\")\n\n# Set movement factor levels for proper ordering\ndf_mem_counts$Movement &lt;- factor(df_mem_counts$Movement, levels = recode_map)\ndf_story_counts$Movement &lt;- factor(df_story_counts$Movement, levels = recode_map)\n\n# Plot for 'memories'\nmem_plot &lt;- ggplot(df_mem_counts, aes(x = Movement, y = count, fill = Movement)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  facet_wrap(~ Composer, scales = \"free_x\") +  # Separate Beethoven & Hough\n  theme_minimal() +\n  labs(title = \"Movement Counts for Memories\", x = \"Movement\", y = \"Count\") +\n theme(axis.title.x = element_blank(),  # Remove x-axis title\n        axis.text.x = element_blank(),   # Remove x-axis labels\n        axis.ticks.x = element_blank()) +\n  scale_fill_brewer(palette = \"Set3\") + \n  guides(fill = guide_legend(title = \"Movement\")) +\n  scale_y_continuous(breaks = scales::breaks_pretty(n = 5))  \n\n\nggsave(\"Plots/Descriptive/Movement counts for memories, part 1.png\", plot = mem_plot, width = 7, height = 5, dpi = 300, bg = 'white')\n\nknitr::include_graphics(\"Plots/Descriptive/Movement counts for memories, part 1.png\")\n\n\n\n\n\n\n\n# Plot for 'stories'\nstory_plot &lt;- ggplot(df_story_counts, aes(x = Movement, y = count, fill = Movement)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  facet_wrap(~ Composer, scales = \"free_x\") +  # Separate Beethoven & Hough\n  theme_minimal() +\n  labs(title = \"Movement Counts for Stories\", x = \"Movement\", y = \"Count\") +\n theme(axis.title.x = element_blank(),  # Remove x-axis title\n        axis.text.x = element_blank(),   # Remove x-axis labels\n        axis.ticks.x = element_blank()) +\n  scale_fill_brewer(palette = \"Set3\") + \n  guides(fill = guide_legend(title = \"Movement\")) +\n  scale_y_continuous(breaks = scales::breaks_pretty(n = 5)) \n\nggsave(\"Plots/Descriptive/Movement counts for stories, part 1.png\", plot = story_plot, width = 7, height = 5, dpi = 300, bg = 'white')\n\nknitr::include_graphics(\"Plots/Descriptive/Movement counts for stories, part 1.png\")\n\n\n\n\n\n\n\n\nIn the next descriptive phase, we want to look at how demographics variables are associated with different types of thoughts. First, we tidy the demographics data and make sure it’s classed in the right way.\n\n#Creating a 'floor' variable, with 2 factors showing downstairs and upstairs locations.\ndata &lt;- data %&gt;%\n  mutate(Floor = ifelse(Location %in% c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"), \"Downstairs\", \"Upstairs\")) %&gt;% relocate(Floor, .after = Location)\n\n#Removing NA.s?\ndata &lt;- data %&gt;%\n  filter(!is.na(Age) & !is.na(Gender) & !is.na(Music_listening) & !is.na(Floor) & !is.na(Fictional_story) & !is.na(Practice)) %&gt;%\n  filter(!is.infinite(Age) & !is.infinite(Gender) & !is.infinite(Music_listening) & \n         !is.infinite(Floor) & !is.infinite(Fictional_story) & !is.infinite(Practice))\n\n#Making sure demographic variables are classed in the right way.\ndata$Age &lt;- as.numeric(data$Age)\ndata$Practice &lt;- as.numeric(as.character(data$Practice))\ndata$Gender &lt;- factor(data$Gender,  levels = c('Male', 'Female', 'Other'))\ndata$Music_listening &lt;- factor(data$Music_listening, levels = c('Very rarely', 'Somewhat rarely', 'Moderately frequently', 'Frequently', 'Very frequently'))\ndata$Floor &lt;- factor(data$Floor, levels = c('Downstairs', 'Upstairs'))\ndata$Fictional_story &lt;- factor(data$Fictional_story, \n                               levels = c(\"Not at all\", \"A small amount of the time\", \n                                          \"A moderate amount of the time\", \n                                          \"Most of the time\", \"All of the time\"))\n\nVarious descriptive plots can be made, but there are 3 below for age, gender and floor.\n\nDescriptive plot for Age and types of thought – age is converted into a grouped variable:\n\n\n# Create Age bins\ndata &lt;- data %&gt;%\n  mutate(Age_group = cut(Age, \n                         breaks = seq(floor(min(Age, na.rm = TRUE)), \n                                      ceiling(max(Age, na.rm = TRUE)) + 20, by = 5), \n                         include.lowest = TRUE, \n                         right = FALSE))\n\n# List of outcome variables\noutcome_vars &lt;- c(\"Fictional_story\", \"Abstract_shapes\", \"Sensory_sensations\", \n                  \"Life_experiences\", \"Media\", \"Music\", \"Future_plans\", \n                  \"Building\", \"Everyday\")\n\n# Converting outcome variables to factors with consistent levels for each thought type\ndata[outcome_vars] &lt;- lapply(data[outcome_vars], factor, \n                             levels = c(\"Not at all\", \"A small amount of the time\", \n                                        \"A moderate amount of the time\", \"Most of the time\", \n                                        \"All of the time\"))\n\n# Creating a single summary_data dataframe\nsummary_data &lt;- data %&gt;%\n  pivot_longer(cols = all_of(outcome_vars), names_to = \"Outcome\", values_to = \"Response\") %&gt;%\n  group_by(Age_group, Outcome, Response) %&gt;%\n  summarise(count = n(), .groups = \"drop\") %&gt;%\n  group_by(Age_group, Outcome) %&gt;%\n  mutate(prop = count / sum(count)) %&gt;%\n  ungroup()\n\n# Looping through each outcome variable to generate plots\nplot_list &lt;- list()\n\nfor (outcome in outcome_vars) {\n    plot_data &lt;- summary_data %&gt;% filter(Outcome == outcome)\n    plot &lt;- ggplot(plot_data, aes(x = Age_group, y = prop, fill = Response)) +\n      geom_bar(stat = \"identity\", position = \"stack\", alpha = 0.8) + \n      labs(x = \"\\nAge Group\", y = \"Proportion\\n\", title = paste(outcome)) +\n      scale_fill_manual(name = \"Response Level\",\n                        values = setNames(c(\"#deebf7\", \"#9ecae1\", \"#3182bd\", \"#08519c\", \"#08306b\"),\n                                          levels(data[[outcome]]))) +\n      theme_minimal() + \n      theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n  plot_list[[outcome]] &lt;- plot\n}\n\n# Arranging plots in a grid and saving\n\ntitle_grob &lt;- textGrob(\"Types of Thoughts by Age Group, First Half\", gp = gpar(fontsize = 16, fontface = \"bold\"))\n\nAge_thoughts_grid &lt;- invisible(grid.arrange(\n  grobs = plot_list, \n  ncol = 3, \n  top = title_grob  \n))\n\n\n\n\n\n\n\nggsave(\"Plots/Descriptive/Age and thoughts, part 1.png\", plot = Age_thoughts_grid, width = 20, height = 12, dpi = 300, bg = 'white')\n\nknitr::include_graphics(\"Plots/Descriptive/Age and thoughts, part 1.png\")\n\n\n\n\n\n\n\n\n\nDescriptive plot for gender and types of thought – for now gender has been filtered for male and female.\n\n\n# Remove missing values + filter\ndata &lt;- data %&gt;%\n  filter(!is.na(Gender)) %&gt;% filter(Gender != 'Other')\n\n# Create a single summary_data dataframe\nsummary_data &lt;- data %&gt;%\n  pivot_longer(cols = all_of(outcome_vars), names_to = \"Outcome\", values_to = \"Response\") %&gt;%\n  group_by(Gender, Outcome, Response) %&gt;%\n  summarise(count = n(), .groups = \"drop\") %&gt;%\n  group_by(Gender, Outcome) %&gt;%\n  mutate(prop = count / sum(count)) %&gt;%\n  ungroup()\n\n# Looping through each outcome variable to generate plots\nplot_list &lt;- list()\n\nfor (outcome in outcome_vars) {\n    plot_data &lt;- summary_data %&gt;% filter(Outcome == outcome)\n    plot &lt;- ggplot(plot_data, aes(x = Gender, y = prop, fill = Response)) +\n      geom_bar(stat = \"identity\", position = \"stack\", alpha = 0.8) + \n      labs(x = \"\\nGender\", y = \"Proportion\\n\", title = paste(outcome)) +\n      scale_fill_manual(name = \"Response Level\",\n                        values = setNames(c(\"#deebf7\", \"#9ecae1\", \"#3182bd\", \"#08519c\", \"#08306b\"),\n                                          levels(data[[outcome]]))) +\n      theme_minimal() + \n      theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n  plot_list[[outcome]] &lt;- plot\n}\n\ntitle_grob &lt;- textGrob(\"Types of Thoughts by Gender, First Half\", gp = gpar(fontsize = 16, fontface = \"bold\"))\n\nGender_thoughts_grid &lt;- grid.arrange(\n  grobs = plot_list, \n  ncol = 3, \n  top = title_grob  \n)\n\n\n\n\n\n\n\nggsave(\"Plots/Descriptive/Gender and thoughts, part 1.png\", plot = Gender_thoughts_grid, width = 20, height = 12, dpi = 300, bg = 'white')\n\nknitr::include_graphics(\"Plots/Descriptive/Gender and thoughts, part 1.png\")\n\n\n\n\n\n\n\n\n\nDescriptive plot for floor\n\n\n# Remove missing values\ndata &lt;- data %&gt;%\n  filter(!is.na(Floor))\n\n# Create a single summary_data dataframe\nsummary_data &lt;- data %&gt;%\n  pivot_longer(cols = all_of(outcome_vars), names_to = \"Outcome\", values_to = \"Response\") %&gt;%\n  group_by(Floor, Outcome, Response) %&gt;%\n  summarise(count = n(), .groups = \"drop\") %&gt;%\n  group_by(Floor, Outcome) %&gt;%\n  mutate(prop = count / sum(count)) %&gt;%\n  ungroup()\n\n# Looping through each outcome variable to generate plots\nplot_list &lt;- list()\n\nfor (outcome in outcome_vars) {\n    plot_data &lt;- summary_data %&gt;% filter(Outcome == outcome)\n    plot &lt;- ggplot(plot_data, aes(x = Floor, y = prop, fill = Response)) +\n      geom_bar(stat = \"identity\", position = \"stack\", alpha = 0.8) + \n      labs(x = \"\\nFloor\", y = \"Proportion\\n\", title = paste(outcome)) +\n      scale_fill_manual(name = \"Response Level\",\n                        values = setNames(c(\"#deebf7\", \"#9ecae1\", \"#3182bd\", \"#08519c\", \"#08306b\"),\n                                          levels(data[[outcome]]))) +\n      theme_minimal() + \n      theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n  plot_list[[outcome]] &lt;- plot\n}\n\ntitle_grob &lt;- textGrob(\"Types of Thoughts by Floor, First Half\", gp = gpar(fontsize = 16, fontface = \"bold\"))\n\nFloor_thoughts_grid &lt;- grid.arrange(\n  grobs = plot_list, \n  ncol = 3, \n  top = title_grob  \n)\n\n\n\n\n\n\n\nggsave(\"Plots/Descriptive/Floor and thoughts, part 1.png\", plot = Floor_thoughts_grid, width = 20, height = 12, dpi = 300, bg = 'white')\n\nknitr::include_graphics(\"Plots/Descriptive/Floor and thoughts, part 1.png\")\n\n\n\n\n\n\n\n\n##Modelling 1\nThe next phase in the analysis is to begin constructing some ordinal regression models describing the relationship between demographic data and thought types.\nI’m starting by filtering through the demographic variables for each thought type, and seeing which ones, if any, have effects on thought types in an ordinal regression model.\n\n# List to store results\nmodels &lt;- list()\nstepwise_models &lt;- list()\n\n# Loop through selected outcomes\nfor (outcome in outcome_vars) {\n  formula &lt;- as.formula(paste(outcome, \"~ Age + Gender + Music_listening + Practice + Floor\"))\n  \n  # Drop rows with NA values in the outcome or predictors\n  vars_to_check &lt;- c(outcome, \"Age\", \"Gender\", \"Music_listening\", \"Practice\", \"Floor\")\n  data_subset &lt;- data[complete.cases(data[vars_to_check]), ]\n\n  # Debugging message\n  cat(\"\\nProcessing:\", outcome, \n      \" | Rows before:\", nrow(data), \n      \" | Rows after NA removal:\", nrow(data_subset), \"\\n\")\n\n  tryCatch({\n    # Fit proportional odds model\n    model &lt;- polr(formula, data = data_subset, Hess = TRUE, method = \"probit\", \n                  control = list(maxit = 1000), na.action = na.exclude)\n    \n    # Store model\n    models[[outcome]] &lt;- model\n    \n    # Print summary\n    cat(\"\\nSummary for\", outcome, \":\\n\")\n    print(summary(model))\n    \n    # Perform stepwise regression\n    step_model &lt;- step(model, direction = \"backward\", trace = FALSE)\n    stepwise_models[[outcome]] &lt;- step_model\n    \n    # Print stepwise summary\n    cat(\"\\nStepwise Model Summary for\", outcome, \":\\n\")\n    print(summary(step_model))\n    \n  }, error = function(e) {\n    cat(\"\\nSkipping\", outcome, \"due to error:\", conditionMessage(e), \"\\n\")\n  })\n}\n\n\nProcessing: Fictional_story  | Rows before: 84  | Rows after NA removal: 61 \n\n\n\nSummary for Fictional_story :\nCall:\npolr(formula = formula, data = data_subset, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                         Value Std. Error   t value\nAge                                  -0.001074   0.008367 -0.128353\nGenderFemale                         -0.146478   0.295069 -0.496420\nMusic_listeningSomewhat rarely        0.196832   1.285168  0.153156\nMusic_listeningModerately frequently -0.149644   1.168670 -0.128047\nMusic_listeningFrequently             0.130946   1.131141  0.115765\nMusic_listeningVery frequently       -0.009055   1.158496 -0.007816\nPractice                             -0.021158   0.009452 -2.238525\nFloorUpstairs                         0.078698   0.404125  0.194736\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.8221  1.1152   \nA small amount of the time|A moderate amount of the time  0.0458  1.1123   \nA moderate amount of the time|Most of the time            0.7709  1.1248   \nMost of the time|All of the time                          1.3847  1.1439   \n                                                         t value\nNot at all|A small amount of the time                    -0.7371\nA small amount of the time|A moderate amount of the time  0.0412\nA moderate amount of the time|Most of the time            0.6854\nMost of the time|All of the time                          1.2106\n\nResidual Deviance: 168.3786 \nAIC: 192.3786 \n\n\n\nStepwise Model Summary for Fictional_story :\nCall:\npolr(formula = Fictional_story ~ Practice, data = data_subset, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nCoefficients:\n            Value Std. Error t value\nPractice -0.02015   0.008693  -2.318\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.7494  0.2131   \nA small amount of the time|A moderate amount of the time  0.1085  0.1971   \nA moderate amount of the time|Most of the time            0.8360  0.2193   \nMost of the time|All of the time                          1.4498  0.2874   \n                                                         t value\nNot at all|A small amount of the time                    -3.5160\nA small amount of the time|A moderate amount of the time  0.5503\nA moderate amount of the time|Most of the time            3.8118\nMost of the time|All of the time                          5.0444\n\nResidual Deviance: 169.4059 \nAIC: 179.4059 \n\nProcessing: Abstract_shapes  | Rows before: 84  | Rows after NA removal: 61 \n\n\n\nSummary for Abstract_shapes :\nCall:\npolr(formula = formula, data = data_subset, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                         Value Std. Error t value\nAge                                   0.001271   0.009014  0.1410\nGenderFemale                          0.093205   0.319961  0.2913\nMusic_listeningSomewhat rarely       -1.477958   1.359519 -1.0871\nMusic_listeningModerately frequently -2.124072   1.229084 -1.7282\nMusic_listeningFrequently            -0.995012   1.163714 -0.8550\nMusic_listeningVery frequently       -0.690983   1.192354 -0.5795\nPractice                             -0.016750   0.010302 -1.6259\nFloorUpstairs                        -0.475930   0.435169 -1.0937\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.4611  1.1532   \nA small amount of the time|A moderate amount of the time -0.5559  1.1405   \nA moderate amount of the time|Most of the time            0.4785  1.1387   \nMost of the time|All of the time                          0.7653  1.1656   \n                                                         t value\nNot at all|A small amount of the time                    -1.2669\nA small amount of the time|A moderate amount of the time -0.4874\nA moderate amount of the time|Most of the time            0.4202\nMost of the time|All of the time                          0.6565\n\nResidual Deviance: 119.5797 \nAIC: 143.5797 \n\n\n\nStepwise Model Summary for Abstract_shapes :\nCall:\npolr(formula = Abstract_shapes ~ Music_listening + Practice, \n    data = data_subset, control = list(maxit = 1000), na.action = na.exclude, \n    Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                        Value Std. Error t value\nMusic_listeningSomewhat rarely       -1.98179    1.23690  -1.602\nMusic_listeningModerately frequently -2.39434    1.13347  -2.112\nMusic_listeningFrequently            -1.31041    1.10308  -1.188\nMusic_listeningVery frequently       -1.12628    1.07945  -1.043\nPractice                             -0.01793    0.01011  -1.773\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.5863  1.0793   \nA small amount of the time|A moderate amount of the time -0.6972  1.0639   \nA moderate amount of the time|Most of the time            0.3386  1.0631   \nMost of the time|All of the time                          0.6327  1.0972   \n                                                         t value\nNot at all|A small amount of the time                    -1.4698\nA small amount of the time|A moderate amount of the time -0.6553\nA moderate amount of the time|Most of the time            0.3185\nMost of the time|All of the time                          0.5766\n\nResidual Deviance: 121.0018 \nAIC: 139.0018 \n\nProcessing: Sensory_sensations  | Rows before: 84  | Rows after NA removal: 61 \n\n\n\nSummary for Sensory_sensations :\nCall:\npolr(formula = formula, data = data_subset, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                        Value Std. Error t value\nAge                                   0.02476    0.01054  2.3489\nGenderFemale                          0.27112    0.36272  0.7475\nMusic_listeningSomewhat rarely        3.59638    0.58580  6.1392\nMusic_listeningModerately frequently  3.00268    0.41736  7.1944\nMusic_listeningFrequently             4.32913    0.32113 13.4807\nMusic_listeningVery frequently        4.01011    0.31958 12.5482\nPractice                             -0.02515    0.01132 -2.2227\nFloorUpstairs                        -0.21556    0.43701 -0.4933\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                     5.2045  0.5928   \nA small amount of the time|A moderate amount of the time  6.0390  0.6292   \nA moderate amount of the time|Most of the time            6.6223  0.6993   \nMost of the time|All of the time                         11.3879  0.6993   \n                                                         t value\nNot at all|A small amount of the time                     8.7791\nA small amount of the time|A moderate amount of the time  9.5985\nA moderate amount of the time|Most of the time            9.4701\nMost of the time|All of the time                         16.2851\n\nResidual Deviance: 95.99886 \nAIC: 119.9989 \n\n\n\nStepwise Model Summary for Sensory_sensations :\nCall:\npolr(formula = Sensory_sensations ~ Age + Practice, data = data_subset, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nCoefficients:\n            Value Std. Error t value\nAge       0.01568   0.008905   1.761\nPractice -0.01784   0.010245  -1.741\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                     1.0503  0.5039   \nA small amount of the time|A moderate amount of the time  1.8248  0.5331   \nA moderate amount of the time|Most of the time            2.3367  0.5813   \nMost of the time|All of the time                          5.4469 18.4486   \n                                                         t value\nNot at all|A small amount of the time                     2.0844\nA small amount of the time|A moderate amount of the time  3.4230\nA moderate amount of the time|Most of the time            4.0200\nMost of the time|All of the time                          0.2952\n\nResidual Deviance: 103.7518 \nAIC: 115.7518 \n\nProcessing: Life_experiences  | Rows before: 84  | Rows after NA removal: 61 \n\n\n\nSummary for Life_experiences :\nCall:\npolr(formula = formula, data = data_subset, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                        Value Std. Error t value\nAge                                  -0.02225   0.008496 -2.6187\nGenderFemale                          0.20244   0.287339  0.7045\nMusic_listeningSomewhat rarely       -0.42582   1.291673 -0.3297\nMusic_listeningModerately frequently  0.24876   1.183557  0.2102\nMusic_listeningFrequently             0.11775   1.150719  0.1023\nMusic_listeningVery frequently        0.18804   1.170665  0.1606\nPractice                             -0.01583   0.009241 -1.7133\nFloorUpstairs                        -0.05942   0.395468 -0.1503\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -2.0873  1.1514   \nA small amount of the time|A moderate amount of the time -1.1389  1.1338   \nA moderate amount of the time|Most of the time           -0.0187  1.1278   \nMost of the time|All of the time                          0.9150  1.1592   \n                                                         t value\nNot at all|A small amount of the time                    -1.8128\nA small amount of the time|A moderate amount of the time -1.0045\nA moderate amount of the time|Most of the time           -0.0165\nMost of the time|All of the time                          0.7893\n\nResidual Deviance: 160.8484 \nAIC: 184.8484 \n\n\n\nStepwise Model Summary for Life_experiences :\nCall:\npolr(formula = Life_experiences ~ Age + Practice, data = data_subset, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nCoefficients:\n            Value Std. Error t value\nAge      -0.02116   0.007521  -2.813\nPractice -0.01476   0.008576  -1.721\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -2.1970  0.4624   \nA small amount of the time|A moderate amount of the time -1.2615  0.4227   \nA moderate amount of the time|Most of the time           -0.1595  0.4067   \nMost of the time|All of the time                          0.7564  0.4659   \n                                                         t value\nNot at all|A small amount of the time                    -4.7513\nA small amount of the time|A moderate amount of the time -2.9842\nA moderate amount of the time|Most of the time           -0.3921\nMost of the time|All of the time                          1.6235\n\nResidual Deviance: 162.6645 \nAIC: 174.6645 \n\nProcessing: Media  | Rows before: 84  | Rows after NA removal: 61 \n\n\n\nSummary for Media :\nCall:\npolr(formula = formula, data = data_subset, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                         Value Std. Error t value\nAge                                   0.004096   0.009031  0.4535\nGenderFemale                         -0.237291   0.322584 -0.7356\nMusic_listeningSomewhat rarely        5.905293   0.490346 12.0431\nMusic_listeningModerately frequently  4.151073   0.353335 11.7483\nMusic_listeningFrequently             5.017131   0.289628 17.3227\nMusic_listeningVery frequently        5.130711   0.289774 17.7059\nPractice                             -0.022223   0.010437 -2.1293\nFloorUpstairs                        -0.347515   0.439608 -0.7905\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                     4.4974  0.5439   \nA small amount of the time|A moderate amount of the time  5.4229  0.5417   \nA moderate amount of the time|Most of the time            6.2040  0.5840   \nMost of the time|All of the time                         10.6364  0.5840   \n                                                         t value\nNot at all|A small amount of the time                     8.2683\nA small amount of the time|A moderate amount of the time 10.0116\nA moderate amount of the time|Most of the time           10.6234\nMost of the time|All of the time                         18.2131\n\nResidual Deviance: 120.8456 \nAIC: 144.8456 \n\n\n\nStepwise Model Summary for Media :\nCall:\npolr(formula = Media ~ Music_listening + Practice, data = data_subset, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nCoefficients:\n                                       Value Std. Error t value\nMusic_listeningSomewhat rarely        5.2295     0.4401  11.884\nMusic_listeningModerately frequently  3.7457     0.2942  12.732\nMusic_listeningFrequently             4.5367     0.2845  15.947\nMusic_listeningVery frequently        4.5158     0.2325  19.419\nPractice                             -0.0238     0.0102  -2.333\n\nIntercepts:\n                                                         Value    Std. Error\nNot at all|A small amount of the time                      4.1209   0.1882  \nA small amount of the time|A moderate amount of the time   5.0257   0.2075  \nA moderate amount of the time|Most of the time             5.7994   0.2751  \nMost of the time|All of the time                           9.7697 109.9753  \n                                                         t value \nNot at all|A small amount of the time                     21.8965\nA small amount of the time|A moderate amount of the time  24.2257\nA moderate amount of the time|Most of the time            21.0784\nMost of the time|All of the time                           0.0888\n\nResidual Deviance: 122.9507 \nAIC: 140.9507 \n\nProcessing: Music  | Rows before: 84  | Rows after NA removal: 60 \n\n\n\nSummary for Music :\nCall:\npolr(formula = formula, data = data_subset, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                         Value Std. Error t value\nAge                                  -0.004468   0.008593 -0.5199\nGenderFemale                          0.194068   0.297491  0.6523\nMusic_listeningSomewhat rarely        0.449359   1.312317  0.3424\nMusic_listeningModerately frequently  1.265349   1.189638  1.0636\nMusic_listeningFrequently             1.285028   1.156238  1.1114\nMusic_listeningVery frequently        1.542188   1.182027  1.3047\nPractice                              0.024122   0.009543  2.5278\nFloorUpstairs                        -0.436482   0.419113 -1.0414\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -4.1708 12.2018   \nA small amount of the time|A moderate amount of the time -0.1838  1.1183   \nA moderate amount of the time|Most of the time            0.8053  1.1265   \nMost of the time|All of the time                          2.4567  1.1531   \n                                                         t value\nNot at all|A small amount of the time                    -0.3418\nA small amount of the time|A moderate amount of the time -0.1644\nA moderate amount of the time|Most of the time            0.7148\nMost of the time|All of the time                          2.1304\n\nResidual Deviance: 131.5353 \nAIC: 155.5353 \n\n\n\nStepwise Model Summary for Music :\nCall:\npolr(formula = Music ~ Practice, data = data_subset, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n           Value Std. Error t value\nPractice 0.02512   0.008792   2.857\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -4.4808 24.9395   \nA small amount of the time|A moderate amount of the time -0.9346  0.2347   \nA moderate amount of the time|Most of the time           -0.0256  0.1991   \nMost of the time|All of the time                          1.5688  0.2741   \n                                                         t value\nNot at all|A small amount of the time                    -0.1797\nA small amount of the time|A moderate amount of the time -3.9825\nA moderate amount of the time|Most of the time           -0.1287\nMost of the time|All of the time                          5.7229\n\nResidual Deviance: 136.9328 \nAIC: 146.9328 \n\nProcessing: Future_plans  | Rows before: 84  | Rows after NA removal: 58 \n\n\n\nSummary for Future_plans :\nCall:\npolr(formula = formula, data = data_subset, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                        Value Std. Error t value\nAge                                  -0.02398   0.009323 -2.5719\nGenderFemale                         -0.38286   0.307048 -1.2469\nMusic_listeningSomewhat rarely        0.76891   1.295553  0.5935\nMusic_listeningModerately frequently -0.33201   1.171041 -0.2835\nMusic_listeningFrequently            -0.47619   1.134170 -0.4199\nMusic_listeningVery frequently       -0.18523   1.163575 -0.1592\nPractice                             -0.02811   0.011861 -2.3700\nFloorUpstairs                         0.04684   0.421922  0.1110\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -2.5089  1.1496   \nA small amount of the time|A moderate amount of the time -1.6860  1.1278   \nA moderate amount of the time|Most of the time           -0.9847  1.1210   \nMost of the time|All of the time                          0.3438  1.1679   \n                                                         t value\nNot at all|A small amount of the time                    -2.1825\nA small amount of the time|A moderate amount of the time -1.4950\nA moderate amount of the time|Most of the time           -0.8784\nMost of the time|All of the time                          0.2944\n\nResidual Deviance: 149.1068 \nAIC: 173.1068 \n\n\n\nStepwise Model Summary for Future_plans :\nCall:\npolr(formula = Future_plans ~ Age + Practice, data = data_subset, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nCoefficients:\n            Value Std. Error t value\nAge      -0.02124   0.008144  -2.609\nPractice -0.03079   0.011149  -2.761\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -2.0072  0.4838   \nA small amount of the time|A moderate amount of the time -1.2319  0.4638   \nA moderate amount of the time|Most of the time           -0.5677  0.4514   \nMost of the time|All of the time                          0.6554  0.4905   \n                                                         t value\nNot at all|A small amount of the time                    -4.1492\nA small amount of the time|A moderate amount of the time -2.6559\nA moderate amount of the time|Most of the time           -1.2575\nMost of the time|All of the time                          1.3361\n\nResidual Deviance: 154.6512 \nAIC: 166.6512 \n\nProcessing: Building  | Rows before: 84  | Rows after NA removal: 59 \n\n\n\nSkipping Building due to error: initial value in 'vmmin' is not finite \n\nProcessing: Everyday  | Rows before: 84  | Rows after NA removal: 59 \n\n\n\nSummary for Everyday :\nCall:\npolr(formula = formula, data = data_subset, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                        Value Std. Error  t value\nAge                                  -0.01726   0.008709 -1.98168\nGenderFemale                         -0.05770   0.294993 -0.19559\nMusic_listeningSomewhat rarely       -0.24774   1.305694 -0.18974\nMusic_listeningModerately frequently  0.69493   1.194269  0.58189\nMusic_listeningFrequently             0.70559   1.163648  0.60636\nMusic_listeningVery frequently        0.95569   1.188091  0.80439\nPractice                             -0.02188   0.009692 -2.25721\nFloorUpstairs                        -0.03675   0.404641 -0.09083\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.3507  1.1475   \nA small amount of the time|A moderate amount of the time -0.1688  1.1396   \nA moderate amount of the time|Most of the time            0.7742  1.1506   \nMost of the time|All of the time                          1.9241  1.2117   \n                                                         t value\nNot at all|A small amount of the time                    -1.1770\nA small amount of the time|A moderate amount of the time -0.1481\nA moderate amount of the time|Most of the time            0.6729\nMost of the time|All of the time                          1.5879\n\nResidual Deviance: 149.0369 \nAIC: 173.0369 \n\n\n\nStepwise Model Summary for Everyday :\nCall:\npolr(formula = Everyday ~ Age + Practice, data = data_subset, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nCoefficients:\n            Value Std. Error t value\nAge      -0.01528   0.007472  -2.045\nPractice -0.01684   0.008812  -1.911\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.8182  0.4469   \nA small amount of the time|A moderate amount of the time -0.6863  0.4165   \nA moderate amount of the time|Most of the time            0.2035  0.4130   \nMost of the time|All of the time                          1.3080  0.5218   \n                                                         t value\nNot at all|A small amount of the time                    -4.0686\nA small amount of the time|A moderate amount of the time -1.6478\nA moderate amount of the time|Most of the time            0.4928\nMost of the time|All of the time                          2.5066\n\nResidual Deviance: 153.4401 \nAIC: 165.4401 \n\n\nEmmeans plots can be used to visualise the ordinal regression models, as shown below here for the relationship between Age and each thought type.\n\n# Only some of the outcome variables can be successfully plotted\nlibrary(gridExtra)\n\noutcome_vars &lt;- c(\"Fictional_story\", \"Abstract_shapes\",\n                  \"Life_experiences\", \"Music\", \"Future_plans\", \n                   \"Everyday\")\n\nplot_list &lt;- list()\nfor (outcome in outcome_vars) {\nmodel &lt;- polr(as.formula(paste(outcome, \"~ Age\")), data = data, Hess = TRUE)\n\npredicted_probs &lt;- ggemmeans(model, terms = c(\"Age\"))\n  \nplot &lt;- ggplot(predicted_probs, aes(x = x, y = predicted, fill = response.level)) +\n    geom_area() + \n    labs(x = \"\\nAge\", \n         y = \"Predicted Probability\\n\", \n         title = paste(outcome, \"by Age\")) +\n    scale_fill_manual(name = NULL,\n                      values = setNames(c(\"#deebf7\", \"#9ecae1\", \"#3182bd\", \"#08519c\", \"#08306b\"),\n                                        levels(data[[outcome]])),\n                      labels = c(\"Not at all\", \"A small amount of the time\", \"A moderate amount of the time\", \"Most of the time\", \"All of the time\"),\n                      breaks = c(\"Not at all\", \"A small amount of the time\", \"A moderate amount of the time\", \"Most of the time\", \"All of the time\")\n                      ) + theme_minimal()\n  \n\n  plot_list[[outcome]] &lt;- plot\n}\n\ntitle_grob &lt;- textGrob(\"Types of Thoughts by Age, First Half\", gp = gpar(fontsize = 16, fontface = \"bold\"))\n\nAge_thoughts_models &lt;- grid.arrange(\n  grobs = plot_list, \n  ncol = 3, \n  top = title_grob  \n)\n\n\n\n\n\n\n\nggsave(\"Plots/Models/Thoughts and age, part 1.png\", plot = Age_thoughts_models, width = 17, height = 7, dpi = 300, bg = 'white')\n\nknitr::include_graphics(\"Plots/Models/Thoughts and age, part 1.png\")\n\n\n\n\n\n\n\n\nAfter narrowing down models using the step() method above, the main predictors are Music_listening and Practice for abstract shapes, Age for life experiences, Practice for music, and Age and practice for future plans. These can be plotted below.\n\nmod1 &lt;- polr(formula = Abstract_shapes ~ Practice + Music_listening, data = data, Hess = TRUE, method = \"probit\")\nmod2 &lt;- polr(formula = Life_experiences ~ Age, data = data, Hess = TRUE, method = \"probit\")\nmod3 &lt;- polr(formula = Music ~ Practice, data = data, Hess = TRUE, method = \"probit\")\nmod4 &lt;- polr(formula = Future_plans ~ Age + Practice, data = data, Hess = TRUE, method = \"probit\")\n\npred1 &lt;- ggemmeans(mod1, terms = c(\"Practice\", \"Music_listening\"))\npred2 &lt;- ggemmeans(mod2, terms = c(\"Age\"))\npred3 &lt;- ggemmeans(mod3, terms = c(\"Practice\"))\npred4 &lt;- ggemmeans(mod4, terms = c(\"Age\", \"Practice\"))\n\ncustom_colors &lt;- c(\"Not at all\" = \"#deebf7\", \n                   \"A small amount of the time\" = \"#9ecae1\", \n                   \"A moderate amount of the time\" = \"#3182bd\", \n                   \"Most of the time\" = \"#08519c\", \n                   \"All of the time\" = \"#08306b\")\n\n\n# Plot for Abstract Shapes by Music Listening & Practice\np1 &lt;- ggplot(pred1, aes(x = x, y = predicted, fill = response.level)) +\n     geom_area(alpha = 1) + \n     facet_wrap(~ group, scales = \"free_y\") +  \n     labs(x = \"Practice\", y = \"Predicted Probability\\n\", title = \"Abstract Shapes by Practice, Faceted by Classical Music Listening\") +\n     scale_fill_manual(name = NULL, values = custom_colors) +\n     theme_minimal() +\n     theme(legend.position = \"bottom\")\n\nggsave(\"Plots/Models/Top model Abstract Shapes, part 1.png\", plot = p1, width = 10, height = 7, dpi = 300, bg = 'white')\n\nknitr::include_graphics(\"Plots/Models/Top model Abstract Shapes, part 1.png\")\n\n\n\n\n\n\n\n# Plot Life Experiences by Age\np2 &lt;- ggplot(pred2, aes(x = x, y = predicted, fill = response.level)) +\n  geom_area() + \n  labs(x = \"\\nAge\", y = \"Predicted Probability\\n\", title = \"Life Experiences by Age\") +\n  scale_fill_manual(name = NULL, values = custom_colors) +\n  theme_minimal()\n\nggsave(\"Plots/Models/Top model Life Experiences, part 1.png\", plot = p2, width = 6, height = 4, dpi = 300, bg = 'white')\n\nknitr::include_graphics(\"Plots/Models/Top model Life Experiences, part 1.png\")\n\n\n\n\n\n\n\n# Plot for Music by Practice\np3 &lt;- ggplot(pred3, aes(x = x, y = predicted, fill = response.level)) +\n  geom_area() + \n  labs(x = \"\\nPractice\", y = \"Predicted Probability\\n\", title = \"Music by Practice\") +\n  scale_fill_manual(name = NULL, values = custom_colors) +\n  theme_minimal()\n\nggsave(\"Plots/Models/Top model Music, part 1.png\", plot = p3, width = 6, height = 4, dpi = 300, bg = 'white')\n\nknitr::include_graphics(\"Plots/Models/Top model Music, part 1.png\")\n\n\n\n\n\n\n\n#Plot for Future Plans by Age & Practice -- converting practice into a grouped variable for readability\npractice_grouped_data &lt;- practice_grouped_data &lt;- data %&gt;%\n  mutate(Practice_grouped = cut(Practice, \n                                breaks = seq(min(Practice, na.rm = TRUE), \n                                            max(Practice, na.rm = TRUE), \n                                            by = 10)))\n\nmod5 &lt;- polr(formula = Future_plans ~ Age + Practice_grouped, data = practice_grouped_data, Hess = TRUE, method = \"probit\")\n\npred5 &lt;- ggemmeans(mod5, terms = c(\"Age\", \"Practice_grouped\"))\n\np4 &lt;- ggplot(pred5, aes(x = x, y = predicted, fill = response.level)) +\n     geom_area(alpha = 1) +\n     facet_wrap(~ group, scales = \"free_y\") +  # Facet by Practice\n     labs(x = \"\\nAge\", y = \"Predicted Probability\\n\", title = \"Future Plans by Age, Faceted by Practice\") +\n     scale_fill_manual(name = NULL, values = custom_colors) +\n     theme_minimal() +\n     theme(legend.position = \"bottom\")\n\nggsave(\"Plots/Models/Top model Future Plans, part 1.png\", plot = p4, width = 10, height = 7, dpi = 300, bg = 'white')\n\nknitr::include_graphics(\"Plots/Models/Top model Future Plans, part 1.png\")\n\n\n\n\n\n\n\n\nWe can also examine the nature of the interactions between demographics variables. The vif() outputs below indicate that multicollinearity shouldn’t be a problem.\n\ndemographics &lt;- c('Age', 'Gender', 'Music_listening', 'Practice', 'Floor')\ndemographics_data &lt;- dplyr::select(data, all_of(demographics))\n\n# Convert categorical variables to numeric\ndemographics_numeric &lt;- demographics_data %&gt;%\n  mutate(\n    Gender = as.numeric(factor(Gender)),\n    Music_listening = as.numeric(factor(Music_listening, ordered = TRUE)),  \n    Floor = as.numeric(factor(Floor))\n  ) \n\n# Compute correlation matrix\ncor_matrix &lt;- cor(demographics_numeric, use = \"pairwise.complete.obs\")\n\n# Plot heatmap\ncorrplot(cor_matrix, method = \"color\", type = \"lower\", \n         tl.col = \"black\", tl.srt = 45, addCoef.col = \"white\", \n         col = colorRampPalette(c(\"blue\", \"white\", \"red\"))(200))\n\n\n\n\n\n\n\n#Here's another way of visualising the interactions\nggplot(data, aes(x = Age, y = Practice, color = Floor)) +\n  geom_point(alpha = 0.6) +  \n  geom_smooth(method = \"lm\", se = FALSE, linetype = \"dashed\") +\n  facet_wrap(~ Floor) +\n  labs(title = \"Age vs. Practice by Floor\",\n       x = \"Age\", \n       y = \"Practice (Number of Years)\") +\n  theme_minimal()\n\n\n\n\n\n\n\n#Checking for collinearity\nmodel1 &lt;- lm(Age ~ Practice + Gender + Music_listening + Floor, data = demographics_numeric)\nmodel2 &lt;- lm(Gender ~ Age + Practice + Music_listening + Floor, data = demographics_numeric)\nmodel3 &lt;- lm(Practice ~ Age + Gender + Music_listening + Floor, data = demographics_numeric)\nmodel4 &lt;- lm(Music_listening ~ Age + Gender + Practice + Floor, data = demographics_numeric)\nmodel5 &lt;- lm(Floor ~ Age + Gender + Practice + Music_listening, data = demographics_numeric)\nvif(model1)\n\n       Practice          Gender Music_listening           Floor \n       1.091853        1.032313        1.114286        1.112759 \n\nvif(model2)\n\n            Age        Practice Music_listening           Floor \n       1.061276        1.107218        1.114276        1.136213 \n\nvif(model3)\n\n            Age          Gender Music_listening           Floor \n       1.059136        1.044730        1.060017        1.130097 \n\nvif(model4)\n\n     Age   Gender Practice    Floor \n1.074120 1.044797 1.053371 1.119429 \n\nvif(model5)\n\n            Age          Gender        Practice Music_listening \n       1.030322        1.023328        1.078698        1.075257 \n\n\n#Part 2 ##Descriptive 2\nWe can now do a similar analysis for the data from the second part of the concert.\nFirst we load the dataset.\n\n#Loading dataset, sheet 2\n\nlibrary(conflicted)\nconflict_prefer(\"filter\", \"dplyr\")\n\ndata_paper2 &lt;- read_csv(\"input/PUC2.csv\")\n\n\nrecode &lt;- c(\"1\" = \"Not at all\",\n                \"2\" = \"A small amount of the time\",\n                \"3\" = \"A moderate amount of the time\",\n                \"4\" = \"Most of the time\",\n                \"5\" = \"All of the time\")\n\nrecode2 &lt;- c(\"1\" = \"Not at all\",\n             \"2\" = \"Slightly\",\n             \"3\" = \"Moderately\",\n             \"4\" = \"Mostly\",\n             \"5\" = \"Entirely\")\n\ndata_paper2[, 2:10] &lt;- lapply(data_paper2[, 2:10], function(x) recode[as.character(x)])\ndata_paper2[, 13:15] &lt;- lapply(data_paper2[, 13:15], function(x) recode2[as.character(x)])\ndata_paper2[, 18:20] &lt;- lapply(data_paper2[, 18:20], function(x) recode2[as.character(x)])\n\n\ndata_qualtrics2 &lt;- read_csv(\"input_qualtrics/PUC2.csv\")\ndata_qualtrics2 &lt;- data_qualtrics2 %&gt;% dplyr::filter(Finished == \"TRUE\") %&gt;% \n  dplyr::select(-StartDate, -EndDate, -Status, -Progress, -Duration, \n         -RecordedDate, -DistributionChannel, -UserLanguage, -Finished, -ResponseId)\n\nAgain, the Qualtrics data also needs reloading and reworking.\n\nfinal_qualtrics2 &lt;- data_qualtrics2 %&gt;%\n    filter(!is.na(Movement_mem)) %&gt;% filter(!is.na(Movement_story)) %&gt;%\n  mutate(Movement_mem = paste0(\"Br\", str_extract(Movement_mem, \"\\\\d+\"))) %&gt;%\n    mutate(Movement_story = paste0(\"Br\", str_extract(Movement_story, \"\\\\d+\")))\n\nCombine the Qualtrics and paper data.\n\ndata2 &lt;- bind_rows(data_paper2, final_qualtrics2)\n\nAs in the first half, a dataframe is created showing thought types in a long format with counts for each frequency.\n\nthought_types &lt;- c(\"Fictional_story\", \"Abstract_shapes\", \"Sensory_sensations\", \"Life_experiences\", \"Media\", \"Music\", \"Future_plans\", \"Building\", \"Everyday\")\n\nthoughts_long2 &lt;- data2 %&gt;%\n  pivot_longer(cols = thought_types,\n               names_to = \"Category\", \n               values_to = \"Response\") %&gt;%\n  count(Category, Response) %&gt;% \n  mutate(Response = factor(Response, \n                           levels = c(\"Not at all\", \n                                      \"A small amount of the time\", \n                                      \"A moderate amount of the time\", \n                                      \"Most of the time\", \n                                      \"All of the time\"))) %&gt;% \n  mutate(Category = factor(Category, \n                           levels = rev(c(\"Fictional_story\", \n                                          \"Abstract_shapes\", \n                                          \"Sensory_sensations\", \n                                          \"Life_experiences\", \n                                          \"Media\", \n                                          \"Music\", \n                                          \"Future_plans\", \n                                          \"Building\", \n                                          \"Everyday\")))) %&gt;% \n  filter(!is.na(Response))\n\nThis dataframe is used to create a plot showing the counts for each type of thought during the first half.\n\nggplot(thoughts_long2, aes(x = Response, y = Category, fill = n)) +\n  geom_tile(color = \"white\") +  # Add white borders to tiles\n  scale_fill_gradient(low = \"lightblue\", high = \"darkblue\") +  # Adjust color gradient\n  labs(title = \"Category Response Counts\", x = \"Response\", y = \"Category\", fill = \"Count\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels\n\n\n\n\n\n\n\nggsave(\"Plots/Descriptive/Overall thought counts, part2.png\", width = 7, height = 5, dpi = 300, bg = 'white')\n\nWe need to pull the demographic information from the first half of the concert and match it to the second half, making sure it’s matched to the right participant.\n\ndemographics &lt;- data[, c(\"Age\", \"Gender\", \"Music_listening\", \"Practice\", \"Location\", \"Participant_number\", \"ID\")] \n\ndata2 &lt;- data2 %&gt;%\n  mutate(join_key = ifelse(!is.na(Participant_number), Participant_number, ID))\n\ndemographics &lt;- demographics %&gt;%\n  mutate(join_key = ifelse(!is.na(Participant_number), Participant_number, ID))\n\ndata2 &lt;- data2 %&gt;%\n  left_join(demographics, by = \"join_key\")\n\ndata2 &lt;- data2 %&gt;% dplyr::select(-Participant_number.y, -ID.y, -Participant_number.x, -ID.x)\n\nNow we look at the the counts for the movements people select as invoking the most vivid memory or story.\n\nmems2 &lt;- data2$Movement_mem %&gt;% na.omit() %&gt;% toupper()\nstories2 &lt;- data2$Movement_story %&gt;% na.omit() %&gt;% toupper()\n\n\n# Split values by \";\", \",\", or whitespace\nsplit_values_mem2 &lt;- unlist(strsplit(mems2, \"[; ,]+\"))\nsplit_values_story2 &lt;- unlist(strsplit(stories2, \"[; ,]+\"))\n\n# Trim whitespace\nsplit_values_mem2 &lt;- trimws(split_values_mem2)\nsplit_values_story2 &lt;- trimws(split_values_story2)\n\n# Count occurrences\nvalue_counts_mem2 &lt;- table(split_values_mem2)\nvalue_counts_story2 &lt;- table(split_values_story2)\n\n\n# Define the recode map\nrecode_map2 &lt;- list(\n  BR1 = \"Brahms, movement 1 — Allegro non troppo\", \n  BR2 = \"Brahms, movement 2 — Andante, un poco adagio\", \n  BR3 = \"Brahms, movement 3 — Scherzo: Allegro\", \n  BR4 = \"Brahms, movement 4 — Finale\"\n)\n\n\nsplit_values_mem2 &lt;- as.character(split_values_mem2)\nsplit_values_story2 &lt;- as.character(split_values_story2)\n\nrecoded_mem2 &lt;- dplyr::recode(split_values_mem2, !!!recode_map2)\nrecoded_story2 &lt;- dplyr::recode(split_values_story2, !!!recode_map2)\n\n# Convert to data frames of counts\ndf_mem_counts2 &lt;- as.data.frame(table(recoded_mem2))\ncolnames(df_mem_counts2) &lt;- c(\"Movement\", \"count\")\n\ndf_story_counts2 &lt;- as.data.frame(table(recoded_story2))\ncolnames(df_story_counts2) &lt;- c(\"Movement\", \"count\")\n\n# Set movement factor levels for proper ordering\ndf_mem_counts2$Movement &lt;- factor(df_mem_counts2$Movement, levels = recode_map2)\ndf_story_counts2$Movement &lt;- factor(df_story_counts2$Movement, levels = recode_map2)\n\n# Plot for 'memories'\nmem_plot2 &lt;- ggplot(df_mem_counts2, aes(x = Movement, y = count, fill = Movement)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  theme_minimal() +\n  labs(title = \"Movement Counts for Memories\", x = \"Movement\", y = \"Count\") +\n theme(axis.title.x = element_blank(), \n        axis.text.x = element_blank(),  \n        axis.ticks.x = element_blank()) +\n  scale_fill_brewer(palette = \"Set3\") + \n  guides(fill = guide_legend(title = \"Movement\")) +\n  scale_y_continuous(breaks = scales::breaks_pretty(n = 5))  \n\n\nggsave(\"Plots/Descriptive/Movement counts for memories, part 2.png\", plot = mem_plot2, width = 7, height = 5, dpi = 300, bg = 'white')\n\nknitr::include_graphics(\"Plots/Descriptive/Movement counts for memories, part 2.png\")\n\n\n\n\n\n\n\n# Plot for 'stories'\nstory_plot2 &lt;- ggplot(df_story_counts2, aes(x = Movement, y = count, fill = Movement)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  theme_minimal() +\n  labs(title = \"Movement Counts for Stories\", x = \"Movement\", y = \"Count\") +\n theme(axis.title.x = element_blank(),  # Remove x-axis title\n        axis.text.x = element_blank(),   # Remove x-axis labels\n        axis.ticks.x = element_blank()) +\n  scale_fill_brewer(palette = \"Set3\") + \n  guides(fill = guide_legend(title = \"Movement\")) +\n  scale_y_continuous(breaks = scales::breaks_pretty(n = 5)) \n\nggsave(\"Plots/Descriptive/Movement counts for stories, part 2.png\", plot = story_plot2, width = 7, height = 5, dpi = 300, bg = 'white')\n\nknitr::include_graphics(\"Plots/Descriptive/Movement counts for stories, part 2.png\")\n\n\n\n\n\n\n\n\nTo look at relationships with demographic variables, we again tidy the demographic data.\n\n#Creating a 'floor' variable, with 2 factors showing downstairs and upstairs locations.\ndata2 &lt;- data2 %&gt;%\n  mutate(Floor = ifelse(Location %in% c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"), \"Downstairs\", \"Upstairs\")) %&gt;% relocate(Floor, .after = Location)\n\n#Removing NA.s\ndata2 &lt;- data2 %&gt;%\n  filter(!is.na(Age) & !is.na(Gender) & !is.na(Music_listening) & !is.na(Floor) & !is.na(Fictional_story) & !is.na(Practice)) %&gt;%\n  filter(!is.infinite(Age) & !is.infinite(Gender) & !is.infinite(Music_listening) & \n         !is.infinite(Floor) & !is.infinite(Fictional_story) & !is.infinite(Practice))\n\n#Making sure demographic variables are classed in the right way.\ndata2$Age &lt;- as.numeric(data2$Age)\ndata2$Practice &lt;- as.numeric(as.character(data2$Practice))\ndata2$Gender &lt;- factor(data2$Gender,  levels = c('Male', 'Female', 'Other'))\ndata2$Music_listening &lt;- factor(data2$Music_listening, levels = c('Very rarely', 'Somewhat rarely', 'Moderately frequently', 'Frequently', 'Very frequently'))\ndata2$Floor &lt;- factor(data2$Floor, levels = c('Downstairs', 'Upstairs'))\ndata2$Fictional_story &lt;- factor(data2$Fictional_story, \n                               levels = c(\"Not at all\", \"A small amount of the time\", \n                                          \"A moderate amount of the time\", \n                                          \"Most of the time\", \"All of the time\"))\n\nHere are 3 sets of descriptive plots to match those used in part 1, for age, gender and floor.\n\nDescriptive plot for Age and types of thought – age is converted into a grouped variable:\n\n\n# Create Age bins\ndata2 &lt;- data2 %&gt;%\n  mutate(Age_group = cut(Age, \n                         breaks = seq(floor(min(Age, na.rm = TRUE)), \n                                      ceiling(max(Age, na.rm = TRUE)) + 20, by = 5), \n                         include.lowest = TRUE, \n                         right = FALSE))  # Ensures the last group includes the highest value\n\n# List of outcome variables\noutcome_vars &lt;- c(\"Fictional_story\", \"Abstract_shapes\", \"Sensory_sensations\", \n                  \"Life_experiences\", \"Media\", \"Music\", \"Future_plans\", \n                  \"Building\", \"Everyday\")\n\n# Convert all outcome variables to factors with consistent levels\ndata2[outcome_vars] &lt;- lapply(data2[outcome_vars], factor, \n                             levels = c(\"Not at all\", \"A small amount of the time\", \n                                        \"A moderate amount of the time\", \"Most of the time\", \n                                        \"All of the time\"))\n\n# Create a single summary_data dataframe\nsummary_data2 &lt;- data2 %&gt;%\n  pivot_longer(cols = all_of(outcome_vars), names_to = \"Outcome\", values_to = \"Response\") %&gt;%\n  group_by(Age_group, Outcome, Response) %&gt;%\n  summarise(count = n(), .groups = \"drop\") %&gt;%\n  group_by(Age_group, Outcome) %&gt;%\n  mutate(prop = count / sum(count)) %&gt;%\n  ungroup()\n\n# Looping through each outcome variable to generate plots\nplot_list &lt;- list()\nfor (outcome in outcome_vars) {\n  plot_data2 &lt;- summary_data2 %&gt;% filter(Outcome == outcome)\n  plot &lt;- ggplot(plot_data2, aes(x = Age_group, y = prop, fill = Response)) +\n    geom_bar(stat = \"identity\", position = \"stack\", alpha = 0.8) + \n    labs(x = \"\\nAge Group\", y = \"Proportion\\n\", title = paste(outcome)) +\n    scale_fill_manual(\n      name = \"Response Level\",\n      values = setNames(c(\"#deebf7\", \"#9ecae1\", \"#3182bd\", \"#08519c\", \"#08306b\"), \n                      levels(data[[outcome]]))\n    ) +\n    theme_minimal() + theme(axis.text.x = element_text(angle = 45, hjust = 1))\n  \n  plot_list[[outcome]] &lt;- plot\n}\n\nlibrary(grid)\n\n# Arranging plots in a grid and saving\n\ntitle_grob &lt;- textGrob(\"Types of Thoughts by Age, Second Half\", gp = gpar(fontsize = 16, fontface = \"bold\"))\n\nAge_thoughts_grid2 &lt;- grid.arrange(\n  grobs = plot_list, \n  ncol = 3, \n  top = title_grob  \n)\n\n\n\n\n\n\n\nggsave(\"Plots/Descriptive/Age and thoughts, part 2.png\", plot = Age_thoughts_grid2, width = 20, height = 12, dpi = 300, bg = 'white')\n\nknitr::include_graphics(\"Plots/Descriptive/Age and thoughts, part 2.png\")\n\n\n\n\n\n\n\n\n\nDescriptive plot for gender and types of thought.\n\n\n# Remove missing values + filter\ndata2 &lt;- data2 %&gt;%\n  filter(!is.na(Gender)) %&gt;% filter(Gender != 'Other')\n\n# Create a single summary_data dataframe\nsummary_data2 &lt;- data2 %&gt;%\n  pivot_longer(cols = all_of(outcome_vars), names_to = \"Outcome\", values_to = \"Response\") %&gt;%\n  group_by(Gender, Outcome, Response) %&gt;%\n  summarise(count = n(), .groups = \"drop\") %&gt;%\n  group_by(Gender, Outcome) %&gt;%\n  mutate(prop = count / sum(count)) %&gt;%\n  ungroup()\n\n# Looping through each outcome variable to generate plots\nplot_list &lt;- list()\nfor (outcome in outcome_vars) {\n  plot_data2 &lt;- summary_data2 %&gt;% filter(Outcome == outcome)\n  plot2 &lt;- ggplot(plot_data2, aes(x = Gender, y = prop, fill = Response)) +\n    geom_bar(stat = \"identity\", position = \"stack\", alpha = 0.8) + \n    labs(x = \"\\nGender\", y = \"Proportion\\n\", title = paste(outcome)) +\n    scale_fill_manual(\n      name = \"Response Level\",\n      values = setNames(c(\"#deebf7\", \"#9ecae1\", \"#3182bd\", \"#08519c\", \"#08306b\"), \n                      levels(data[[outcome]]))\n    ) +\n    theme_minimal()\n  \n  plot_list[[outcome]] &lt;- plot2\n}\n\ntitle_grob &lt;- textGrob(\"Types of Thoughts by Gender, Second Half\", gp = gpar(fontsize = 16, fontface = \"bold\"))\n\nGender_thoughts_grid2 &lt;- grid.arrange(\n  grobs = plot_list, \n  ncol = 3, \n  top = title_grob  \n)\n\n\n\n\n\n\n\nggsave(\"Plots/Descriptive/Gender and thoughts, part 2.png\", plot = Gender_thoughts_grid2, width = 20, height = 12, dpi = 300, bg = 'white')\nknitr::include_graphics(\"Plots/Descriptive/Gender and thoughts, part 2.png\")\n\n\n\n\n\n\n\n\n\nDescriptive plot for floor\n\n\n# Remove missing values\ndata2 &lt;- data2 %&gt;%\n  filter(!is.na(Floor))\n\n# Create a single summary_data dataframe\nsummary_data2 &lt;- data2 %&gt;%\n  pivot_longer(cols = all_of(outcome_vars), names_to = \"Outcome\", values_to = \"Response\") %&gt;%\n  group_by(Floor, Outcome, Response) %&gt;%\n  summarise(count = n(), .groups = \"drop\") %&gt;%\n  group_by(Floor, Outcome) %&gt;%\n  mutate(prop = count / sum(count)) %&gt;%\n  ungroup()\n\n# Looping through each outcome variable to generate plots\nplot_list &lt;- list()\nfor (outcome in outcome_vars) {\n  plot_data2 &lt;- summary_data2 %&gt;% filter(Outcome == outcome)\n  plot3 &lt;- ggplot(plot_data2, aes(x = Floor, y = prop, fill = Response)) +\n    geom_bar(stat = \"identity\", position = \"stack\", alpha = 0.8) + \n    labs(x = \"\\nFloor\", y = \"Proportion\\n\", title = paste(outcome)) +\n    scale_fill_manual(\n      name = \"Response Level\",\n      values = setNames(c(\"#deebf7\", \"#9ecae1\", \"#3182bd\", \"#08519c\", \"#08306b\"), \n                      levels(data[[outcome]]))\n    ) +\n    theme_minimal()\n\n  plot_list[[outcome]] &lt;- plot3\n}\n\ntitle_grob &lt;- textGrob(\"Types of Thoughts by Floor, Second Half\", gp = gpar(fontsize = 16, fontface = \"bold\"))\n\nFloor_thoughts_grid2 &lt;- grid.arrange(\n  grobs = plot_list, \n  ncol = 3, \n  top = title_grob  \n)\n\n\n\n\n\n\n\nggsave(\"Plots/Descriptive/Floor and thoughts, part 2.png\", plot = Floor_thoughts_grid2, width = 20, height = 12, dpi = 300, bg = 'white')\n\nknitr::include_graphics(\"Plots/Descriptive/Floor and thoughts, part 2.png\")\n\n\n\n\n\n\n\n\n##Modelling 2\nNow we can construct some some ordinal regression models describing the relationship between demographic data and thought types.\nAgain we can filter through the demographic variables for each thought type, and see which ones have effects on thought types.\n\n# List to store results\nmodels &lt;- list()\nstepwise_models &lt;- list()\n\n# Loop through selected outcomes\nfor (outcome in outcome_vars) {\n  \n  # Define formula\n  formula &lt;- as.formula(paste(outcome, \"~ Age + Gender + Music_listening + Practice + Floor\"))\n  \n  tryCatch({\n    # Subset data and drop NAs relevant to formula\n    modeling_data &lt;- na.omit(data2[, all.vars(formula)])\n    \n    # Ensure outcome is ordered (if it makes sense — you might want to tweak this per outcome)\n    modeling_data[[outcome]] &lt;- factor(modeling_data[[outcome]], ordered = TRUE)\n    \n    # Skip if outcome has too few observations in any level\n    level_counts &lt;- table(modeling_data[[outcome]])\n    if (any(level_counts &lt; 3)) {\n      cat(\"\\nSkipping\", outcome, \"due to rare levels in outcome:\\n\")\n      print(level_counts)\n      next\n    }\n    \n    # Skip if any predictor has zero variance\n    predictors &lt;- modeling_data[, setdiff(all.vars(formula), outcome)]\n    if (any(sapply(predictors, function(x) var(as.numeric(x), na.rm = TRUE) == 0))) {\n      cat(\"\\nSkipping\", outcome, \"due to zero-variance predictor.\\n\")\n      next\n    }\n\n    # Fit proportional odds model\n    model &lt;- polr(formula, data = modeling_data, Hess = TRUE, method = \"probit\")\n    models[[outcome]] &lt;- model\n    \n    # Print model summary\n    cat(\"\\nSummary for\", outcome, \":\\n\")\n    print(summary(model))\n    \n    # Run backward stepwise selection\n    step_model &lt;- step(model, direction = \"backward\", trace = FALSE)\n    stepwise_models[[outcome]] &lt;- step_model\n    \n    # Print stepwise summary\n    cat(\"\\nStepwise Model Summary for\", outcome, \":\\n\")\n    print(summary(step_model))\n    \n  }, error = function(e) {\n    cat(\"\\nSkipping\", outcome, \"due to error:\", e$message, \"\\n\")\n  })\n}\n\n\nSummary for Fictional_story :\nCall:\npolr(formula = formula, data = modeling_data, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                         Value Std. Error  t value\nAge                                  -0.007266   0.009421 -0.77131\nGenderFemale                          0.297422   0.345153  0.86171\nMusic_listeningSomewhat rarely        0.053757   1.356046  0.03964\nMusic_listeningModerately frequently -0.831073   1.198822 -0.69324\nMusic_listeningFrequently             0.065118   1.139256  0.05716\nMusic_listeningVery frequently        0.075065   1.164271  0.06447\nPractice                             -0.029347   0.012853 -2.28337\nFloorUpstairs                        -0.432576   0.445537 -0.97091\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.2864  1.1423   \nA small amount of the time|A moderate amount of the time -0.4992  1.1261   \nA moderate amount of the time|Most of the time            0.1002  1.1220   \n                                                         t value\nNot at all|A small amount of the time                    -1.1261\nA small amount of the time|A moderate amount of the time -0.4433\nA moderate amount of the time|Most of the time            0.0893\n\nResidual Deviance: 118.5269 \nAIC: 140.5269 \n\n\n\nStepwise Model Summary for Fictional_story :\nCall:\npolr(formula = Fictional_story ~ Practice, data = modeling_data, \n    Hess = TRUE, method = \"probit\")\n\nCoefficients:\n            Value Std. Error t value\nPractice -0.02391    0.01124  -2.127\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.4866  0.2265   \nA small amount of the time|A moderate amount of the time  0.2046  0.2244   \nA moderate amount of the time|Most of the time            0.7516  0.2451   \n                                                         t value\nNot at all|A small amount of the time                    -2.1478\nA small amount of the time|A moderate amount of the time  0.9119\nA moderate amount of the time|Most of the time            3.0663\n\nResidual Deviance: 126.6955 \nAIC: 134.6955 \n\n\n\nSummary for Abstract_shapes :\nCall:\npolr(formula = formula, data = modeling_data, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                          Value Std. Error  t value\nAge                                   0.0013891    0.01068  0.13009\nGenderFemale                         -0.4455096    0.41343 -1.07759\nMusic_listeningSomewhat rarely        0.3319888    1.43170  0.23188\nMusic_listeningModerately frequently -1.9199441    1.36233 -1.40931\nMusic_listeningFrequently            -0.4226057    1.19872 -0.35255\nMusic_listeningVery frequently        0.1745184    1.22573  0.14238\nPractice                              0.0008659    0.01182  0.07324\nFloorUpstairs                        -1.1576243    0.53391 -2.16818\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.9306  1.1663   \nA small amount of the time|A moderate amount of the time  0.1347  1.1660   \nA moderate amount of the time|Most of the time            0.5429  1.1788   \n                                                         t value\nNot at all|A small amount of the time                    -0.7979\nA small amount of the time|A moderate amount of the time  0.1155\nA moderate amount of the time|Most of the time            0.4605\n\nResidual Deviance: 83.64714 \nAIC: 105.6471 \n\n\n\nStepwise Model Summary for Abstract_shapes :\nCall:\npolr(formula = Abstract_shapes ~ Music_listening + Floor, data = modeling_data, \n    Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                        Value Std. Error  t value\nMusic_listeningSomewhat rarely        0.73038     1.3270  0.55039\nMusic_listeningModerately frequently -1.44105     1.2131 -1.18792\nMusic_listeningFrequently            -0.04938     1.1284 -0.04376\nMusic_listeningVery frequently        0.46310     1.1680  0.39648\nFloorUpstairs                        -1.19185     0.5151 -2.31368\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.5276  1.0557   \nA small amount of the time|A moderate amount of the time  0.5273  1.0557   \nA moderate amount of the time|Most of the time            0.9187  1.0740   \n                                                         t value\nNot at all|A small amount of the time                    -0.4997\nA small amount of the time|A moderate amount of the time  0.4995\nA moderate amount of the time|Most of the time            0.8554\n\nResidual Deviance: 84.86171 \nAIC: 100.8617 \n\nSkipping Sensory_sensations due to rare levels in outcome:\n\n                   Not at all    A small amount of the time \n                           36                             9 \nA moderate amount of the time              Most of the time \n                            4                             1 \n\n\n\nSummary for Life_experiences :\nCall:\npolr(formula = formula, data = modeling_data, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                         Value Std. Error   t value\nAge                                  -0.008149   0.008857 -0.920084\nGenderFemale                         -0.152937   0.327851 -0.466484\nMusic_listeningSomewhat rarely       -0.142142   1.376487 -0.103265\nMusic_listeningModerately frequently  0.006027   1.221946  0.004932\nMusic_listeningFrequently             1.071085   1.185540  0.903458\nMusic_listeningVery frequently        0.893871   1.201603  0.743898\nPractice                             -0.001547   0.009707 -0.159335\nFloorUpstairs                        -0.275990   0.424295 -0.650468\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.0131  1.1560   \nA small amount of the time|A moderate amount of the time  0.2199  1.1532   \nA moderate amount of the time|Most of the time            0.8141  1.1632   \nMost of the time|All of the time                          1.6866  1.1828   \n                                                         t value\nNot at all|A small amount of the time                    -0.8763\nA small amount of the time|A moderate amount of the time  0.1907\nA moderate amount of the time|Most of the time            0.6999\nMost of the time|All of the time                          1.4260\n\nResidual Deviance: 135.6629 \nAIC: 159.6629 \n\n\n\nStepwise Model Summary for Life_experiences :\nCall:\npolr(formula = Life_experiences ~ Music_listening, data = modeling_data, \n    Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                       Value Std. Error t value\nMusic_listeningSomewhat rarely       -0.4943      1.244 -0.3973\nMusic_listeningModerately frequently -0.3092      1.111 -0.2784\nMusic_listeningFrequently             0.8824      1.121  0.7874\nMusic_listeningVery frequently        0.5338      1.090  0.4898\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.6097  1.0711   \nA small amount of the time|A moderate amount of the time  0.6097  1.0711   \nA moderate amount of the time|Most of the time            1.1970  1.0832   \nMost of the time|All of the time                          2.0522  1.1102   \n                                                         t value\nNot at all|A small amount of the time                    -0.5692\nA small amount of the time|A moderate amount of the time  0.5692\nA moderate amount of the time|Most of the time            1.1050\nMost of the time|All of the time                          1.8484\n\nResidual Deviance: 137.0494 \nAIC: 153.0494 \n\nSkipping Media due to rare levels in outcome:\n\n                   Not at all    A small amount of the time \n                           37                             9 \nA moderate amount of the time              Most of the time \n                            2                             1 \n              All of the time \n                            1 \n\nSkipping Music due to rare levels in outcome:\n\n                   Not at all    A small amount of the time \n                            1                             7 \nA moderate amount of the time              Most of the time \n                           16                            13 \n              All of the time \n                           13 \n\n\n\nSummary for Future_plans :\nCall:\npolr(formula = formula, data = modeling_data, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                        Value Std. Error t value\nAge                                  -0.02495   0.009535 -2.6167\nGenderFemale                         -0.86873   0.356602 -2.4361\nMusic_listeningSomewhat rarely       -0.05813   1.367725 -0.0425\nMusic_listeningModerately frequently -0.73227   1.234492 -0.5932\nMusic_listeningFrequently            -0.17014   1.189868 -0.1430\nMusic_listeningVery frequently       -0.32038   1.209775 -0.2648\nPractice                             -0.01457   0.011544 -1.2626\nFloorUpstairs                         0.51751   0.453241  1.1418\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -2.3285  1.1989   \nA small amount of the time|A moderate amount of the time -1.0977  1.1733   \nA moderate amount of the time|Most of the time           -0.3440  1.1837   \nMost of the time|All of the time                          0.1100  1.1949   \n                                                         t value\nNot at all|A small amount of the time                    -1.9422\nA small amount of the time|A moderate amount of the time -0.9356\nA moderate amount of the time|Most of the time           -0.2906\nMost of the time|All of the time                          0.0920\n\nResidual Deviance: 120.2896 \nAIC: 144.2896 \n\n\n\nStepwise Model Summary for Future_plans :\nCall:\npolr(formula = Future_plans ~ Age + Gender, data = modeling_data, \n    Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                Value Std. Error t value\nAge          -0.02807   0.008875  -3.163\nGenderFemale -0.78629   0.336717  -2.335\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -2.2582  0.5546   \nA small amount of the time|A moderate amount of the time -1.0988  0.5044   \nA moderate amount of the time|Most of the time           -0.3768  0.5074   \nMost of the time|All of the time                          0.0665  0.5259   \n                                                         t value\nNot at all|A small amount of the time                    -4.0718\nA small amount of the time|A moderate amount of the time -2.1783\nA moderate amount of the time|Most of the time           -0.7426\nMost of the time|All of the time                          0.1265\n\nResidual Deviance: 124.8591 \nAIC: 136.8591 \n\nSkipping Building due to rare levels in outcome:\n\n                   Not at all    A small amount of the time \n                           28                            11 \nA moderate amount of the time              Most of the time \n                            5                             4 \n              All of the time \n                            2 \n\nSkipping Everyday due to rare levels in outcome:\n\n                   Not at all    A small amount of the time \n                           17                            18 \nA moderate amount of the time               All of the time \n                           13                             2 \n\n\nEmmeans plots are shown here for the relationship between Age and each thought type.\n\n# Only some of the outcome variables can be successfully plotted\n\noutcome_vars &lt;- c(\"Fictional_story\", \"Abstract_shapes\",\n                  \"Life_experiences\", \"Music\", \"Future_plans\", \n                   \"Everyday\")\n\nplot_list &lt;- list()\nfor (outcome in outcome_vars) {\nmodel &lt;- polr(as.formula(paste(outcome, \"~ Age\")), data = data2, Hess = TRUE)\n\npredicted_probs &lt;- ggemmeans(model, terms = c(\"Age\"))\n  \nplot &lt;- ggplot(predicted_probs, aes(x = x, y = predicted, fill = response.level)) +\n    geom_area() + \n    labs(x = \"\\nAge\", y = \"Predicted Probability\\n\", \n         title = paste(outcome, \"by Age\")) +\n    scale_fill_manual(\n      name = NULL,\n      values = setNames(c(\"#deebf7\", \"#9ecae1\", \"#3182bd\", \"#08519c\", \"#08306b\"), \n                      levels(data[[outcome]])),\n      labels = c(\"Not at all\", \"A small amount of the time\", \"A moderate amount of the time\", \n                 \"Most of the time\", \"All of the time\"),\n      breaks = c(\"Not at all\", \"A small amount of the time\", \"A moderate amount of the time\", \n                 \"Most of the time\", \"All of the time\")\n    ) + \n    theme_minimal()\n  \n\n  plot_list[[outcome]] &lt;- plot\n}\n\ntitle_grob &lt;- textGrob(\"Types of Thoughts by Age, Second Half\", gp = gpar(fontsize = 16, fontface = \"bold\"))\n\nAge_thoughts_models &lt;- grid.arrange(\n  grobs = plot_list, \n  ncol = 3, \n  top = title_grob  \n)\n\n\n\n\n\n\n\nggsave(\"Plots/Models/Thoughts and age, part 2.png\", plot = Age_thoughts_models, width = 17, height = 7, dpi = 300, bg = 'white')\n\nknitr::include_graphics(\"Plots/Models/Thoughts and age, part 2.png\")\n\n\n\n\n\n\n\n\nAfter narrowing down models using the step() method above, the main predictors are Practice and Music_listening for Fictional_story, Music_listening and Floor for Abstract Shapes, and Practice for Everyday. These can be plotted below."
  },
  {
    "objectID": "posts/post-with-code/index.html",
    "href": "posts/post-with-code/index.html",
    "title": "Post With Code",
    "section": "",
    "text": "This is a post with executable code.\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this blog"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "PUC_Quarto",
    "section": "",
    "text": "Post With Code\n\n\n\n\n\n\nnews\n\n\ncode\n\n\nanalysis\n\n\n\n\n\n\n\n\n\nApr 22, 2025\n\n\nHarlow Malloc\n\n\n\n\n\n\n\n\n\n\n\n\nWelcome To My Blog\n\n\n\n\n\n\nnews\n\n\n\n\n\n\n\n\n\nApr 19, 2025\n\n\nTristan O’Malley\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/welcome/index.html",
    "href": "posts/welcome/index.html",
    "title": "Welcome To My Blog",
    "section": "",
    "text": "This is the first post in a Quarto blog. Welcome!\n\nSince this post doesn’t specify an explicit image, the first image in the post will be used in the listing page of posts."
  }
]